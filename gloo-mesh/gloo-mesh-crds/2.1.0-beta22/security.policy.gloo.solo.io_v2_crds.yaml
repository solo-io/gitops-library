# Code generated by skv2. DO NOT EDIT.

apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    crd.solo.io/specHash: 5cf437d64821e054
    crd.solo.io/version: 2.1.0
  labels:
    app: gloo-mesh-apis
    app.kubernetes.io/name: gloo-mesh-apis
  name: accesspolicies.security.policy.gloo.solo.io
spec:
  group: security.policy.gloo.solo.io
  names:
    categories:
    - solo-io
    kind: AccessPolicy
    listKind: AccessPolicyList
    plural: accesspolicies
    shortNames:
    - ap
    singular: accesspolicy
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: |-
              AccessPolicy is used to define how a destination service is granted. Specifically it describes
              both how clients should be authenticated and authorized to access the service.
              Refer to [this link](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)
              for further details about cross origin resource sharing.
              AccessPolicies are applied at the *Destination* level.
            properties:
              applyToDestinations:
                description: |-
                  select the destinations where the policy will be applied
                  if left empty, will apply to all destinations in the workspace.
                items:
                  properties:
                    kind:
                      description: the kind of destination being selected. defaults
                        to Kubernetes Service.
                      enum:
                      - SERVICE
                      - VIRTUAL_DESTINATION
                      - EXTERNAL_SERVICE
                      type: string
                    port:
                      description: |-
                        the port on the Destination which receives traffic.
                        Not required if the Destination only exposes a single port.
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - number
                          - required:
                            - name
                      - required:
                        - number
                      - required:
                        - name
                      properties:
                        name:
                          description: the name of the port on the destination objects
                            being targeted.
                          type: string
                        number:
                          description: the number of the port on the destination objects
                            being targeted.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                      type: object
                    selector:
                      description: selector used to match destination objects by their
                        metadata
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                  type: object
                type: array
              config:
                description: The details of the access policy to apply to the selected
                  destinations.
                properties:
                  authn:
                    description: specify how clients will be authenticated to the
                      destination.
                    properties:
                      tlsMode:
                        description: |-
                          specify the type of TLS policy that will be enforced on clients connecting to the destination.
                          note that if service isolation is enabled for the workspace, this field will always be treated as 'STRICT'.
                        enum:
                        - DISABLE
                        - PERMISSIVE
                        - STRICT
                        type: string
                    type: object
                  authz:
                    description: specify how clients will be authorized to access
                      the destination.
                    properties:
                      allowedClients:
                        description: |-
                          the set of client identities that will be permitted to access the destination.
                          Provide a single empty selector to allow access for all client identities.
                        items:
                          properties:
                            requestIdentityMatcher:
                              description: |-
                                Select identities based on properties of the request. If multiple fields are set, they are ANDed together.
                                More information about the individual values can be found here: https://istio.io/latest/docs/reference/config/security/authorization-policy/#Source
                              properties:
                                notRequestPrincipals:
                                  description: Optional. A list of identities to negative
                                    match the request identity.
                                  items:
                                    type: string
                                  type: array
                                requestPrincipals:
                                  description: |-
                                    Optional. A list of identities to match the request identity ("iss/sub" from the JWT).
                                               If omitted all request identity values will be accepted.
                                  items:
                                    type: string
                                  type: array
                              type: object
                            serviceAccountSelector:
                              description: |-
                                Select kubernetes service accounts as identities.
                                When selecting a service account that will be created in the future for use in a AuthorizationPolicy, ONLY provide the name, namespace and cluster where the service account will exist in the selector.
                                Providing labels and/or the workspace for a service account that does not exist in the selector will not result in that service account being added to the resulting AuthorizationPolicy.
                              properties:
                                cluster:
                                  description: |-
                                    Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                                    matching objects across all clusters available in the parent object's workspace.
                                  type: string
                                labels:
                                  additionalProperties:
                                    type: string
                                  description: labels matching those of the object
                                  type: object
                                name:
                                  description: |-
                                    Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                                    matching objects with any name available in the parent object's workspace.
                                  type: string
                                namespace:
                                  description: |-
                                    Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                                    matching objects across all namespaces available in the parent object's workspace.
                                  type: string
                                workspace:
                                  description: |-
                                    Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                                    matching objects across all workspaces available in the parent object's workspace.
                                  type: string
                              type: object
                          type: object
                        type: array
                      allowedMethods:
                        description: |-
                          Optional. A list of HTTP methods to allow (e.g., "GET", "POST").
                                         It is ignored in gRPC case because the value is always "POST".
                                         If not specified, allows any method.
                        items:
                          type: string
                        type: array
                      allowedPaths:
                        description: |-
                          Optional. A list of HTTP paths or gRPC methods to allow.
                                         gRPC methods must be presented as fully-qualified name in the form of
                                         "/packageName.serviceName/methodName" and are case sensitive.
                                         Exact match, prefix match, and suffix match are supported for paths.
                                         For example, the path "/books/review" matches
                                         "/books/review" (exact match), "*books/" (suffix match), or "/books*" (prefix match).

                                         If not specified, allow any path.
                        items:
                          type: string
                        type: array
                    type: object
                type: object
            type: object
          status:
            description: reflects the status of the AccessPolicy
            properties:
              global:
                properties:
                  message:
                    description: |-
                      Additional information about the current state of the resource across all
                      workspace clusters.
                    type: string
                  state:
                    description: |-
                      Whether the resource has been accepted as valid and processed in workspace
                      clusters that it exists in.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - WARNING
                    - FAILED
                    - UNLICENSED
                    type: string
                type: object
              selectedDestinationPorts:
                description: Destination ports selected by the policy
                items:
                  properties:
                    kind:
                      description: the kind of destination being selected. defaults
                        to Kubernetes Service.
                      enum:
                      - SERVICE
                      - VIRTUAL_DESTINATION
                      - EXTERNAL_SERVICE
                      type: string
                    port:
                      description: the port on the destination object being targeted.
                        required if the object provides more than one port.
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - number
                          - required:
                            - name
                      - required:
                        - number
                      - required:
                        - name
                      properties:
                        name:
                          description: the name of the port on the destination objects
                            being targeted.
                          type: string
                        number:
                          description: the number of the port on the destination objects
                            being targeted.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                      type: object
                    ref:
                      description: reference to the destination object by its metadata
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                    subset:
                      additionalProperties:
                        type: string
                      description: select a subset of the destination's endpoints
                        for routing based on their labels.
                      type: object
                    weight:
                      description: |-
                        Specify the proportion of traffic to be forwarded to this destination.
                        Weights across all of the `destinations` must sum to 100.
                        Weight is only relevant when used in the context of a route with multiple destinations.
                      maximum: 4294967295
                      minimum: 0
                      type: integer
                  type: object
                type: array
              workspaces:
                additionalProperties:
                  properties:
                    clusters:
                      additionalProperties:
                        properties:
                          generic:
                            properties:
                              message:
                                description: Additional information about the current
                                  state of the resource.
                                type: string
                              observedGeneration:
                                description: |-
                                  The most recent generation observed in the the object's metadata.
                                  If the `observedGeneration` does not match `metadata.generation`, Gloo Mesh
                                  has not processed the most recent version of this object.
                                format: int64
                                type: integer
                              state:
                                description: |-
                                  Whether the resource has been accepted as valid and processed in the Gloo
                                  Mesh config translation.
                                enum:
                                - PENDING
                                - ACCEPTED
                                - INVALID
                                - WARNING
                                - FAILED
                                - UNLICENSED
                                type: string
                              updatedAt:
                                description: The last time the status was updated.
                                format: date-time
                                type: string
                            type: object
                        type: object
                      description: |-
                        The status of the resource in each cluster within the
                        workspace.
                      type: object
                  type: object
                description: The status of the resource in each workspace that it
                  exists in.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    crd.solo.io/specHash: c778e041c10af9c2
    crd.solo.io/version: 2.1.0
  labels:
    app: gloo-mesh-apis
    app.kubernetes.io/name: gloo-mesh-apis
  name: corspolicies.security.policy.gloo.solo.io
spec:
  group: security.policy.gloo.solo.io
  names:
    categories:
    - solo-io
    kind: CORSPolicy
    listKind: CORSPolicyList
    plural: corspolicies
    shortNames:
    - cors
    singular: corspolicy
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: |-
              CORSPolicy is used to set a Cross-Origin Resource Sharing policy (CORS) for requests matching selected routes.
              Refer to [this link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS
              for further details about cross origin resource sharing.
              CORSPolicies are applied at the *Route* level.
            properties:
              applyToRoutes:
                description: |-
                  Select the routes where the policy will be applied.
                  If left empty, will apply to all routes in the workspace.
                items:
                  oneOf:
                  - not:
                      anyOf:
                      - required:
                        - route
                      - required:
                        - withDestinations
                  - required:
                    - route
                  - required:
                    - withDestinations
                  properties:
                    route:
                      description: |-
                        select routes based on their labels.
                        these labels can be used to match route tables or individual routes within route tables.
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                    withDestinations:
                      description: |-
                        select routes with `forwardTo` actions based on their destinations.
                        this can be used to apply policy to routes regardless of
                        their labels
                      properties:
                        kind:
                          description: the kind of destination being selected. defaults
                            to Kubernetes Service.
                          enum:
                          - SERVICE
                          - VIRTUAL_DESTINATION
                          - EXTERNAL_SERVICE
                          type: string
                        port:
                          description: |-
                            the port on the Destination which receives traffic.
                            Not required if the Destination only exposes a single port.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - number
                              - required:
                                - name
                          - required:
                            - number
                          - required:
                            - name
                          properties:
                            name:
                              description: the name of the port on the destination
                                objects being targeted.
                              type: string
                            number:
                              description: the number of the port on the destination
                                objects being targeted.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        selector:
                          description: selector used to match destination objects
                            by their metadata
                          properties:
                            cluster:
                              description: |-
                                Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                                matching objects across all clusters available in the parent object's workspace.
                              type: string
                            labels:
                              additionalProperties:
                                type: string
                              description: labels matching those of the object
                              type: object
                            name:
                              description: |-
                                Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                                matching objects with any name available in the parent object's workspace.
                              type: string
                            namespace:
                              description: |-
                                Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                                matching objects across all namespaces available in the parent object's workspace.
                              type: string
                            workspace:
                              description: |-
                                Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                                matching objects across all workspaces available in the parent object's workspace.
                              type: string
                          type: object
                      type: object
                  type: object
                type: array
              config:
                description: The details of the CORS policy to apply to the selected
                  routes.
                properties:
                  allowCredentials:
                    description: |-
                      Indicates whether the caller is allowed to send the actual request
                      (not the preflight) using credentials. Translates to the
                      `Access-Control-Allow-Credentials` header.
                    nullable: true
                    type: boolean
                  allowHeaders:
                    description: |-
                      List of HTTP headers that can be used when requesting the
                      resource. Serialized to the `Access-Control-Allow-Headers` header.
                    items:
                      type: string
                    type: array
                  allowMethods:
                    description: |-
                      List of HTTP methods allowed to access the resource. The content will
                      be serialized to the `Access-Control-Allow-Methods` header.
                    items:
                      type: string
                    type: array
                  allowOrigins:
                    description: String patterns that match allowed origins. An origin
                      is allowed if any of the string matchers match.
                    items:
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - exact
                          - required:
                            - prefix
                          - required:
                            - regex
                          - required:
                            - suffix
                      - required:
                        - exact
                      - required:
                        - prefix
                      - required:
                        - regex
                      - required:
                        - suffix
                      properties:
                        exact:
                          description: Exact string match.
                          type: string
                        ignoreCase:
                          description: If true, indicates the exact/prefix/suffix
                            matching should be case insensitive. This has no effect
                            for the regex match.
                          type: boolean
                        prefix:
                          description: Prefix-based match.
                          type: string
                        regex:
                          description: ECMAscript style regex-based match.
                          type: string
                        suffix:
                          description: Suffix-based match.
                          type: string
                      type: object
                    type: array
                  exposeHeaders:
                    description: |-
                      A list of HTTP headers that browsers are allowed to
                      access. Serialized to the `Access-Control-Expose-Headers` header.
                    items:
                      type: string
                    type: array
                  maxAge:
                    description: |-
                      Specify how long the results of a preflight request can be
                      cached. Serialized to the `Access-Control-Max-Age` header.
                    type: string
                type: object
            type: object
          status:
            description: Reflects the status of the CORSPolicy.
            properties:
              global:
                properties:
                  message:
                    description: |-
                      Additional information about the current state of the resource across all
                      workspace clusters.
                    type: string
                  state:
                    description: |-
                      Whether the resource has been accepted as valid and processed in workspace
                      clusters that it exists in.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - WARNING
                    - FAILED
                    - UNLICENSED
                    type: string
                type: object
              selectedRoutes:
                description: Routes selected by the policy
                items:
                  properties:
                    routeIndex:
                      description: The index of the route on the route table
                      format: int32
                      type: integer
                    routeName:
                      description: The name of the route
                      type: string
                    routeTable:
                      description: The route table containing the route
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                  type: object
                type: array
              workspaces:
                additionalProperties:
                  properties:
                    clusters:
                      additionalProperties:
                        properties:
                          generic:
                            properties:
                              message:
                                description: Additional information about the current
                                  state of the resource.
                                type: string
                              observedGeneration:
                                description: |-
                                  The most recent generation observed in the the object's metadata.
                                  If the `observedGeneration` does not match `metadata.generation`, Gloo Mesh
                                  has not processed the most recent version of this object.
                                format: int64
                                type: integer
                              state:
                                description: |-
                                  Whether the resource has been accepted as valid and processed in the Gloo
                                  Mesh config translation.
                                enum:
                                - PENDING
                                - ACCEPTED
                                - INVALID
                                - WARNING
                                - FAILED
                                - UNLICENSED
                                type: string
                              updatedAt:
                                description: The last time the status was updated.
                                format: date-time
                                type: string
                            type: object
                        type: object
                      description: |-
                        The status of the resource in each cluster within the
                        workspace.
                      type: object
                  type: object
                description: The status of the resource in each workspace that it
                  exists in.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    crd.solo.io/specHash: a17b3a0e418dd9f7
    crd.solo.io/version: 2.1.0
  labels:
    app: gloo-mesh-apis
    app.kubernetes.io/name: gloo-mesh-apis
  name: csrfpolicies.security.policy.gloo.solo.io
spec:
  group: security.policy.gloo.solo.io
  names:
    categories:
    - solo-io
    kind: CSRFPolicy
    listKind: CSRFPolicyList
    plural: csrfpolicies
    shortNames:
    - csrf
    singular: csrfpolicy
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: |-
              CSRFPolicy is used to set safeguard to prevent CSRF (cross-site request forgery) attacks in requests matching selected routes.
              CSRFPolicies are applied at the *Route* level.
            properties:
              applyToRoutes:
                description: |-
                  select the routes where the policy will be applied
                  if left empty, will apply to all routes in the workspace.
                items:
                  oneOf:
                  - not:
                      anyOf:
                      - required:
                        - route
                      - required:
                        - withDestinations
                  - required:
                    - route
                  - required:
                    - withDestinations
                  properties:
                    route:
                      description: |-
                        select routes based on their labels.
                        these labels can be used to match route tables or individual routes within route tables.
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                    withDestinations:
                      description: |-
                        select routes with `forwardTo` actions based on their destinations.
                        this can be used to apply policy to routes regardless of
                        their labels
                      properties:
                        kind:
                          description: the kind of destination being selected. defaults
                            to Kubernetes Service.
                          enum:
                          - SERVICE
                          - VIRTUAL_DESTINATION
                          - EXTERNAL_SERVICE
                          type: string
                        port:
                          description: |-
                            the port on the Destination which receives traffic.
                            Not required if the Destination only exposes a single port.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - number
                              - required:
                                - name
                          - required:
                            - number
                          - required:
                            - name
                          properties:
                            name:
                              description: the name of the port on the destination
                                objects being targeted.
                              type: string
                            number:
                              description: the number of the port on the destination
                                objects being targeted.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        selector:
                          description: selector used to match destination objects
                            by their metadata
                          properties:
                            cluster:
                              description: |-
                                Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                                matching objects across all clusters available in the parent object's workspace.
                              type: string
                            labels:
                              additionalProperties:
                                type: string
                              description: labels matching those of the object
                              type: object
                            name:
                              description: |-
                                Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                                matching objects with any name available in the parent object's workspace.
                              type: string
                            namespace:
                              description: |-
                                Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                                matching objects across all namespaces available in the parent object's workspace.
                              type: string
                            workspace:
                              description: |-
                                Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                                matching objects across all workspaces available in the parent object's workspace.
                              type: string
                          type: object
                      type: object
                  type: object
                type: array
              config:
                description: The details of the CSRF policy to apply to the selected
                  routes.
                properties:
                  additionalOrigins:
                    description: |-
                      Specifies additional source origins that will be allowed in addition to
                      the destination origin.
                    items:
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - exact
                          - required:
                            - prefix
                          - required:
                            - regex
                          - required:
                            - suffix
                      - required:
                        - exact
                      - required:
                        - prefix
                      - required:
                        - regex
                      - required:
                        - suffix
                      properties:
                        exact:
                          description: Exact string match.
                          type: string
                        ignoreCase:
                          description: If true, indicates the exact/prefix/suffix
                            matching should be case insensitive. This has no effect
                            for the regex match.
                          type: boolean
                        prefix:
                          description: Prefix-based match.
                          type: string
                        regex:
                          description: ECMAscript style regex-based match.
                          type: string
                        suffix:
                          description: Suffix-based match.
                          type: string
                      type: object
                    type: array
                  filterEnabled:
                    description: Specifies that CSRF policies will be evaluated, tracked
                      and enforced.
                    type: boolean
                  percentage:
                    description: |-
                      Specifies the % of requests for which the CSRF filter is enabled or when shadow mode is enabled the % of requests
                      evaluated and tracked, but not enforced.

                      If filter_enabled or shadow_enabled is true.
                      Envoy will lookup the runtime key to get the percentage of requests to filter.

                      .. note:: This field defaults to 100
                    nullable: true
                    type: number
                  shadowEnabled:
                    description: |-
                      Specifies that CSRF policies will be evaluated and tracked, but not enforced.

                      This is intended to be used when ``filter_enabled`` is false and will be ignored otherwise.
                    type: boolean
                type: object
            type: object
          status:
            description: reflects the status of the CSRFPolicy
            properties:
              global:
                properties:
                  message:
                    description: |-
                      Additional information about the current state of the resource across all
                      workspace clusters.
                    type: string
                  state:
                    description: |-
                      Whether the resource has been accepted as valid and processed in workspace
                      clusters that it exists in.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - WARNING
                    - FAILED
                    - UNLICENSED
                    type: string
                type: object
              selectedRoutes:
                description: Routes selected by the policy
                items:
                  properties:
                    routeIndex:
                      description: The index of the route on the route table
                      format: int32
                      type: integer
                    routeName:
                      description: The name of the route
                      type: string
                    routeTable:
                      description: The route table containing the route
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                  type: object
                type: array
              workspaces:
                additionalProperties:
                  properties:
                    clusters:
                      additionalProperties:
                        properties:
                          generic:
                            properties:
                              message:
                                description: Additional information about the current
                                  state of the resource.
                                type: string
                              observedGeneration:
                                description: |-
                                  The most recent generation observed in the the object's metadata.
                                  If the `observedGeneration` does not match `metadata.generation`, Gloo Mesh
                                  has not processed the most recent version of this object.
                                format: int64
                                type: integer
                              state:
                                description: |-
                                  Whether the resource has been accepted as valid and processed in the Gloo
                                  Mesh config translation.
                                enum:
                                - PENDING
                                - ACCEPTED
                                - INVALID
                                - WARNING
                                - FAILED
                                - UNLICENSED
                                type: string
                              updatedAt:
                                description: The last time the status was updated.
                                format: date-time
                                type: string
                            type: object
                        type: object
                      description: |-
                        The status of the resource in each cluster within the
                        workspace.
                      type: object
                  type: object
                description: The status of the resource in each workspace that it
                  exists in.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    crd.solo.io/specHash: 21fac13512de40f1
    crd.solo.io/version: 2.1.0
  labels:
    app: gloo-mesh-apis
    app.kubernetes.io/name: gloo-mesh-apis
  name: extauthpolicies.security.policy.gloo.solo.io
spec:
  group: security.policy.gloo.solo.io
  names:
    categories:
    - solo-io
    kind: ExtAuthPolicy
    listKind: ExtAuthPolicyList
    plural: extauthpolicies
    shortNames:
    - extauth
    singular: extauthpolicy
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: |-
              ExtAuthPolicy is used to enforce external authorization/authentication of traffic matching selected routes or arriving at selected destinations.
              All ExtAuthPolicies in a workspace require an ExtAuthServer to in order to function.
              If no ExtAuthServer is specified, a default configuration will be used.
              ExtAuthRoutePolicies can be applied at both the *Route* and *Destination* levels.
              Default is to apply policy to all destinations.
            properties:
              applyToDestinations:
                description: |-
                  Select the destinations where the policy will be applied.
                  Default behavior if no selectors are specified is to apply to all destinations in the workspace.
                  If left empty and the route selector is set, no extauth policy on destinations will be applied.
                items:
                  properties:
                    kind:
                      description: the kind of destination being selected. defaults
                        to Kubernetes Service.
                      enum:
                      - SERVICE
                      - VIRTUAL_DESTINATION
                      - EXTERNAL_SERVICE
                      type: string
                    port:
                      description: |-
                        the port on the Destination which receives traffic.
                        Not required if the Destination only exposes a single port.
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - number
                          - required:
                            - name
                      - required:
                        - number
                      - required:
                        - name
                      properties:
                        name:
                          description: the name of the port on the destination objects
                            being targeted.
                          type: string
                        number:
                          description: the number of the port on the destination objects
                            being targeted.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                      type: object
                    selector:
                      description: selector used to match destination objects by their
                        metadata
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                  type: object
                type: array
              applyToRoutes:
                description: |-
                  Select the routes where the policy will be applied.
                  If left empty, no extauth policy will be applied to any routes in the workspace.
                items:
                  oneOf:
                  - not:
                      anyOf:
                      - required:
                        - route
                      - required:
                        - withDestinations
                  - required:
                    - route
                  - required:
                    - withDestinations
                  properties:
                    route:
                      description: |-
                        select routes based on their labels.
                        these labels can be used to match route tables or individual routes within route tables.
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                    withDestinations:
                      description: |-
                        select routes with `forwardTo` actions based on their destinations.
                        this can be used to apply policy to routes regardless of
                        their labels
                      properties:
                        kind:
                          description: the kind of destination being selected. defaults
                            to Kubernetes Service.
                          enum:
                          - SERVICE
                          - VIRTUAL_DESTINATION
                          - EXTERNAL_SERVICE
                          type: string
                        port:
                          description: |-
                            the port on the Destination which receives traffic.
                            Not required if the Destination only exposes a single port.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - number
                              - required:
                                - name
                          - required:
                            - number
                          - required:
                            - name
                          properties:
                            name:
                              description: the name of the port on the destination
                                objects being targeted.
                              type: string
                            number:
                              description: the number of the port on the destination
                                objects being targeted.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        selector:
                          description: selector used to match destination objects
                            by their metadata
                          properties:
                            cluster:
                              description: |-
                                Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                                matching objects across all clusters available in the parent object's workspace.
                              type: string
                            labels:
                              additionalProperties:
                                type: string
                              description: labels matching those of the object
                              type: object
                            name:
                              description: |-
                                Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                                matching objects with any name available in the parent object's workspace.
                              type: string
                            namespace:
                              description: |-
                                Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                                matching objects across all namespaces available in the parent object's workspace.
                              type: string
                            workspace:
                              description: |-
                                Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                                matching objects across all workspaces available in the parent object's workspace.
                              type: string
                          type: object
                      type: object
                  type: object
                type: array
              config:
                description: The details of the external auth policy to apply to the
                  selected routes and destinations.
                oneOf:
                - not:
                    anyOf:
                    - required:
                      - disable
                    - required:
                      - glooAuth
                    - required:
                      - customAuth
                - required:
                  - disable
                - required:
                  - glooAuth
                - required:
                  - customAuth
                properties:
                  customAuth:
                    description: Use this field if you are running your own custom
                      extauth server. The destination service must be configured to
                      use a custom ext auth service via a ExtAuthDestinationPolicy.
                    properties:
                      contextExtensions:
                        additionalProperties:
                          type: string
                        description: |-
                          When a request matches the route or on which this configuration is applied,
                          Gloo Mesh will add the given context_extensions to the request that is sent to the external authorization server.
                          This allows the server to base the auth decision on metadata that you define on the source of the request.

                          This attribute is analogous to Envoy's config.filter.http.ext_authz.v2.CheckSettings. See the official
                          [Envoy documentation](https://www.envoyproxy.io/docs/envoy/latest/api-v2/config/filter/http/ext_authz/v2/ext_authz.proto.html?highlight=ext_authz#config-filter-http-ext-authz-v2-checksettings)
                          for more details.
                        type: object
                    type: object
                  disable:
                    description: Set to true to disable auth on the route.
                    type: boolean
                  glooAuth:
                    description: Configure the selected route or destination with
                      auth options provided by the Gloo Mesh Ext Auth service. The
                      Ext Auth Service can be specified  must be configured to use
                      a Gloo Ext Auth service via a ExtAuthDestinationPolicy.
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  server:
                    description: |-
                      reference to the ExtAuthServer to use for this policy.
                      Currently routes on a single gateway must share a single ExtAuthServer.
                      If none is provided, the default Gloo ExtAuthServer will be used.
                    properties:
                      cluster:
                        description: the cluster of the object. if the field is omitted,
                          Gloo Mesh will use the same cluster as the parent object
                          containing this reference.
                        type: string
                      name:
                        description: the name of the object
                        type: string
                      namespace:
                        description: the namespace of the object. if the field is
                          omitted, Gloo Mesh will use the same namespace as the parent
                          object containing this reference.
                        type: string
                    type: object
                type: object
            type: object
          status:
            description: reflects the status of the ExtAuthPolicy
            properties:
              global:
                properties:
                  message:
                    description: |-
                      Additional information about the current state of the resource across all
                      workspace clusters.
                    type: string
                  state:
                    description: |-
                      Whether the resource has been accepted as valid and processed in workspace
                      clusters that it exists in.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - WARNING
                    - FAILED
                    - UNLICENSED
                    type: string
                type: object
              selectedDestinationPorts:
                description: Destination ports selected by the policy
                items:
                  properties:
                    kind:
                      description: the kind of destination being selected. defaults
                        to Kubernetes Service.
                      enum:
                      - SERVICE
                      - VIRTUAL_DESTINATION
                      - EXTERNAL_SERVICE
                      type: string
                    port:
                      description: the port on the destination object being targeted.
                        required if the object provides more than one port.
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - number
                          - required:
                            - name
                      - required:
                        - number
                      - required:
                        - name
                      properties:
                        name:
                          description: the name of the port on the destination objects
                            being targeted.
                          type: string
                        number:
                          description: the number of the port on the destination objects
                            being targeted.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                      type: object
                    ref:
                      description: reference to the destination object by its metadata
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                    subset:
                      additionalProperties:
                        type: string
                      description: select a subset of the destination's endpoints
                        for routing based on their labels.
                      type: object
                    weight:
                      description: |-
                        Specify the proportion of traffic to be forwarded to this destination.
                        Weights across all of the `destinations` must sum to 100.
                        Weight is only relevant when used in the context of a route with multiple destinations.
                      maximum: 4294967295
                      minimum: 0
                      type: integer
                  type: object
                type: array
              selectedRoutes:
                description: Routes selected by the policy
                items:
                  properties:
                    routeIndex:
                      description: The index of the route on the route table
                      format: int32
                      type: integer
                    routeName:
                      description: The name of the route
                      type: string
                    routeTable:
                      description: The route table containing the route
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                  type: object
                type: array
              workspaces:
                additionalProperties:
                  properties:
                    clusters:
                      additionalProperties:
                        properties:
                          generic:
                            properties:
                              message:
                                description: Additional information about the current
                                  state of the resource.
                                type: string
                              observedGeneration:
                                description: |-
                                  The most recent generation observed in the the object's metadata.
                                  If the `observedGeneration` does not match `metadata.generation`, Gloo Mesh
                                  has not processed the most recent version of this object.
                                format: int64
                                type: integer
                              state:
                                description: |-
                                  Whether the resource has been accepted as valid and processed in the Gloo
                                  Mesh config translation.
                                enum:
                                - PENDING
                                - ACCEPTED
                                - INVALID
                                - WARNING
                                - FAILED
                                - UNLICENSED
                                type: string
                              updatedAt:
                                description: The last time the status was updated.
                                format: date-time
                                type: string
                            type: object
                        type: object
                      description: |-
                        The status of the resource in each cluster within the
                        workspace.
                      type: object
                  type: object
                description: The status of the resource in each workspace that it
                  exists in.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    crd.solo.io/specHash: bb11b1ec67cad9c
    crd.solo.io/version: 2.1.0
  labels:
    app: gloo-mesh-apis
    app.kubernetes.io/name: gloo-mesh-apis
  name: wafpolicies.security.policy.gloo.solo.io
spec:
  group: security.policy.gloo.solo.io
  names:
    categories:
    - solo-io
    kind: WAFPolicy
    listKind: WAFPolicyList
    plural: wafpolicies
    shortNames:
    - waf
    singular: wafpolicy
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: |-
              WAFPolicy is used to set safeguard your services with the functionality of Web ApplicationFirewall
              WAFPolicies are applied at the *Route* level.
            properties:
              applyToRoutes:
                description: |-
                  select the routes where the policy will be applied
                  if left empty, will apply to all routes in the workspace.
                items:
                  oneOf:
                  - not:
                      anyOf:
                      - required:
                        - route
                      - required:
                        - withDestinations
                  - required:
                    - route
                  - required:
                    - withDestinations
                  properties:
                    route:
                      description: |-
                        select routes based on their labels.
                        these labels can be used to match route tables or individual routes within route tables.
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                    withDestinations:
                      description: |-
                        select routes with `forwardTo` actions based on their destinations.
                        this can be used to apply policy to routes regardless of
                        their labels
                      properties:
                        kind:
                          description: the kind of destination being selected. defaults
                            to Kubernetes Service.
                          enum:
                          - SERVICE
                          - VIRTUAL_DESTINATION
                          - EXTERNAL_SERVICE
                          type: string
                        port:
                          description: |-
                            the port on the Destination which receives traffic.
                            Not required if the Destination only exposes a single port.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - number
                              - required:
                                - name
                          - required:
                            - number
                          - required:
                            - name
                          properties:
                            name:
                              description: the name of the port on the destination
                                objects being targeted.
                              type: string
                            number:
                              description: the number of the port on the destination
                                objects being targeted.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        selector:
                          description: selector used to match destination objects
                            by their metadata
                          properties:
                            cluster:
                              description: |-
                                Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                                matching objects across all clusters available in the parent object's workspace.
                              type: string
                            labels:
                              additionalProperties:
                                type: string
                              description: labels matching those of the object
                              type: object
                            name:
                              description: |-
                                Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                                matching objects with any name available in the parent object's workspace.
                              type: string
                            namespace:
                              description: |-
                                Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                                matching objects across all namespaces available in the parent object's workspace.
                              type: string
                            workspace:
                              description: |-
                                Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                                matching objects across all workspaces available in the parent object's workspace.
                              type: string
                          type: object
                      type: object
                  type: object
                type: array
              config:
                description: The details of the WAF policy to apply to the selected
                  routes.
                properties:
                  auditLogging:
                    description: This instructs the filter what to do with the transaction's
                      audit log.
                    properties:
                      action:
                        enum:
                        - NEVER
                        - RELEVANT_ONLY
                        - ALWAYS
                        type: string
                      location:
                        enum:
                        - FILTER_STATE
                        - DYNAMIC_METADATA
                        type: string
                    type: object
                  customInterventionMessage:
                    description: Custom message to display when an intervention occurs
                    type: string
                  customRuleSets:
                    description: Overwrite the global rules on this route
                    items:
                      properties:
                        directory:
                          description: |-
                            A directory to include. all *.conf files in this directory will be
                            included. sub directories will NOT be checked.
                          type: string
                        files:
                          description: Array of files to include
                          items:
                            type: string
                          type: array
                        ruleStr:
                          description: String of rules which are added directly
                          type: string
                      type: object
                    type: array
                  disableCoreRuleSet:
                    description: Disable the OWASP core rule set from being applied
                    type: boolean
                  requestHeadersOnly:
                    description: |-
                      If set, the body will not be buffered and fed to ModSecurity. Only the
                      headers will. This can help improve performance.
                    type: boolean
                  responseHeadersOnly:
                    type: boolean
                type: object
            type: object
          status:
            description: reflects the status of the WAFPolicy
            properties:
              global:
                properties:
                  message:
                    description: |-
                      Additional information about the current state of the resource across all
                      workspace clusters.
                    type: string
                  state:
                    description: |-
                      Whether the resource has been accepted as valid and processed in workspace
                      clusters that it exists in.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - WARNING
                    - FAILED
                    - UNLICENSED
                    type: string
                type: object
              selectedRoutes:
                description: Routes selected by the policy
                items:
                  properties:
                    routeIndex:
                      description: The index of the route on the route table
                      format: int32
                      type: integer
                    routeName:
                      description: The name of the route
                      type: string
                    routeTable:
                      description: The route table containing the route
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                  type: object
                type: array
              workspaces:
                additionalProperties:
                  properties:
                    clusters:
                      additionalProperties:
                        properties:
                          generic:
                            properties:
                              message:
                                description: Additional information about the current
                                  state of the resource.
                                type: string
                              observedGeneration:
                                description: |-
                                  The most recent generation observed in the the object's metadata.
                                  If the `observedGeneration` does not match `metadata.generation`, Gloo Mesh
                                  has not processed the most recent version of this object.
                                format: int64
                                type: integer
                              state:
                                description: |-
                                  Whether the resource has been accepted as valid and processed in the Gloo
                                  Mesh config translation.
                                enum:
                                - PENDING
                                - ACCEPTED
                                - INVALID
                                - WARNING
                                - FAILED
                                - UNLICENSED
                                type: string
                              updatedAt:
                                description: The last time the status was updated.
                                format: date-time
                                type: string
                            type: object
                        type: object
                      description: |-
                        The status of the resource in each cluster within the
                        workspace.
                      type: object
                  type: object
                description: The status of the resource in each workspace that it
                  exists in.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    crd.solo.io/specHash: f8d954cc521244bb
    crd.solo.io/version: 2.1.0
  labels:
    app: gloo-mesh-apis
    app.kubernetes.io/name: gloo-mesh-apis
  name: jwtpolicies.security.policy.gloo.solo.io
spec:
  group: security.policy.gloo.solo.io
  names:
    categories:
    - solo-io
    kind: JWTPolicy
    listKind: JWTPolicyList
    plural: jwtpolicies
    shortNames:
    - jwt
    singular: jwtpolicy
  scope: Namespaced
  versions:
  - name: v2
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: JWTPolicy used to enable JWT Authentication for routes
            properties:
              applyToRoutes:
                description: |-
                  Select the routes where the policy will be applied.
                  If left empty, no policy will be applied to any routes in the workspace.
                items:
                  oneOf:
                  - not:
                      anyOf:
                      - required:
                        - route
                      - required:
                        - withDestinations
                  - required:
                    - route
                  - required:
                    - withDestinations
                  properties:
                    route:
                      description: |-
                        select routes based on their labels.
                        these labels can be used to match route tables or individual routes within route tables.
                      properties:
                        cluster:
                          description: |-
                            Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                            matching objects across all clusters available in the parent object's workspace.
                          type: string
                        labels:
                          additionalProperties:
                            type: string
                          description: labels matching those of the object
                          type: object
                        name:
                          description: |-
                            Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                            matching objects with any name available in the parent object's workspace.
                          type: string
                        namespace:
                          description: |-
                            Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                            matching objects across all namespaces available in the parent object's workspace.
                          type: string
                        workspace:
                          description: |-
                            Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                            matching objects across all workspaces available in the parent object's workspace.
                          type: string
                      type: object
                    withDestinations:
                      description: |-
                        select routes with `forwardTo` actions based on their destinations.
                        this can be used to apply policy to routes regardless of
                        their labels
                      properties:
                        kind:
                          description: the kind of destination being selected. defaults
                            to Kubernetes Service.
                          enum:
                          - SERVICE
                          - VIRTUAL_DESTINATION
                          - EXTERNAL_SERVICE
                          type: string
                        port:
                          description: |-
                            the port on the Destination which receives traffic.
                            Not required if the Destination only exposes a single port.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - number
                              - required:
                                - name
                          - required:
                            - number
                          - required:
                            - name
                          properties:
                            name:
                              description: the name of the port on the destination
                                objects being targeted.
                              type: string
                            number:
                              description: the number of the port on the destination
                                objects being targeted.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        selector:
                          description: selector used to match destination objects
                            by their metadata
                          properties:
                            cluster:
                              description: |-
                                Only select objects in the matching cluster. If the field is omitted, Gloo Mesh will select
                                matching objects across all clusters available in the parent object's workspace.
                              type: string
                            labels:
                              additionalProperties:
                                type: string
                              description: labels matching those of the object
                              type: object
                            name:
                              description: |-
                                Only select objects with the matching name. If the field is omitted, Gloo Mesh will select
                                matching objects with any name available in the parent object's workspace.
                              type: string
                            namespace:
                              description: |-
                                Only select objects in the matching namespace. If the field is omitted, Gloo Mesh will select
                                matching objects across all namespaces available in the parent object's workspace.
                              type: string
                            workspace:
                              description: |-
                                Only select objects in the given workspace. If the field is omitted, Gloo Mesh will select
                                matching objects across all workspaces available in the parent object's workspace.
                              type: string
                          type: object
                      type: object
                  type: object
                type: array
              config:
                description: |-
                  The details of the JWT policy to apply to the selected routes.

                     Example:
                         Sample JWT Payload: {
                             "org": "solo-io",
                             "iss": "https://localhost",
                             "exp": 4804324736,
                             "iat": 1648651136
                         }

                         Configuration below will enable JWT Authentication for selected routes
                         as well as inject a header into the request containing the value found
                         within the parsed claim if it exists. Empty sources default to extracting
                         JWTs from Authorization Header with prefix "Bearer <Token>"" or Query Param
                         "access_token=<Token>"

                         apiVersion: security.policy.gloo.solo.io/v2
                         kind: JWTPolicy
                         metadata:
                           name: <name>
                           namespace: <namespace>
                         spec:
                           config:
                             providers:
                               <provider_name>:
                                 issuer: "https://localhost"
                                 local:
                                   inline: |
                                     <pem formatted public key>
                                 claimsToHeaders:
                                 - claim: org
                                   header: x-org
                               stage: PRE_AUTHZ

                         This example enables JWT Authentication for selected routes and
                         request will be checked using token found at either X-Auth header with prefix
                         "Bearer <token>" or query param "auth_token=<Token>". Note if a request has both
                         sources available all tokens will need to be valid for the request to be accepted.

                         apiVersion: security.policy.gloo.solo.io/v2
                         kind: JWTPolicy
                         metadata:
                           name: <name>
                           namespace: <namespace>
                         spec:
                           config:
                             providers:
                               <provider_name>:
                                 issuer: "https://localhost"
                                 local:
                                   inline: |
                                     <pem formatted public key>
                                 tokenSource:
                                   header:
                                   - name: "X-Auth"
                                     prefix: "Bearer"
                                   queryParams:
                                   - "auth_token"
                               stage: PRE_AUTHZ
                properties:
                  allowMissingOrFailed:
                    description: |-
                      Allow requests to succeed even if JWT authentication is missing or fails.
                      For example, you might apply multiple policies to your routes to require
                      JWT auth OR another method such as external auth. Set this value to "true"
                      to allow a failed JWT auth request to pass through to the other authentication
                      method. By default, this value is "false" so that requests that fail JWT
                      authentication then fail authorization immediately.
                    type: boolean
                  phase:
                    description: |-
                      Use phase to indicate where in the request chain this JWT Filter should be applied.
                      If no phase is specified, the default will be post AuthZ.
                    oneOf:
                    - not:
                        anyOf:
                        - required:
                          - preAuthz
                        - required:
                          - postAuthz
                    - required:
                      - preAuthz
                    - required:
                      - postAuthz
                    properties:
                      postAuthz:
                        description: Apply this policy after Authorization policies
                          are applied.
                        properties:
                          priority:
                            description: |-
                              The priority at which this policy should be applied relative to other policies defined in the same phase.
                              The lowest priority will be run first and the default priority value is 0.
                            maximum: 2147483647
                            minimum: -2147483648
                            nullable: true
                            type: integer
                        type: object
                      preAuthz:
                        description: Apply this policy before Authorization policies
                          are applied.
                        properties:
                          priority:
                            description: |-
                              The priority at which this policy should be applied relative to other policies defined in the same phase.
                              The lowest priority will be run first and the default priority value is 0.
                            maximum: 2147483647
                            minimum: -2147483648
                            nullable: true
                            type: integer
                        type: object
                    type: object
                  providers:
                    additionalProperties:
                      oneOf:
                      - not:
                          anyOf:
                          - properties:
                              local:
                                oneOf:
                                - not:
                                    anyOf:
                                    - required:
                                      - secretRef
                                    - required:
                                      - inline
                                - required:
                                  - secretRef
                                - required:
                                  - inline
                            required:
                            - local
                          - required:
                            - remote
                      - properties:
                          local:
                            oneOf:
                            - not:
                                anyOf:
                                - required:
                                  - secretRef
                                - required:
                                  - inline
                            - required:
                              - secretRef
                            - required:
                              - inline
                        required:
                        - local
                      - required:
                        - remote
                      properties:
                        audiences:
                          description: |-
                            Optional: A list of intended audiences for this JWT token. A JWT containing any of these
                            audiences will be accepted. If not specified, the audiences in JWT will not be checked.
                          items:
                            type: string
                          type: array
                        claimsToHeaders:
                          description: 'Optional: What claims should be copied to
                            upstream headers.'
                          items:
                            properties:
                              append:
                                description: If the header exists, append to it (true),
                                  or overwrite it (false).
                                type: boolean
                              claim:
                                description: Claim name. for example, "sub"
                                type: string
                              header:
                                description: The header the claim will be copied to.
                                  for example, "x-sub".
                                type: string
                            type: object
                          type: array
                        clockSkewSeconds:
                          description: 'Optional: ClockSkewSeconds is used to verify
                            time constraints, such as `exp` and `npf`. Default is
                            60s'
                          maximum: 4294967295
                          minimum: 0
                          nullable: true
                          type: integer
                        issuer:
                          description: |-
                            Optional: The principal that issued the JWT, usually a URL or an email address.
                            If specified, the iss field in JWT token in the incoming request has to match this field else the request is denied.
                             If left empty the iss field in the JWT token is not checked.
                          type: string
                        keepToken:
                          description: 'Optional: KeepToken is used to keep the JWT
                            in the request post verification.'
                          type: boolean
                        local:
                          description: Local can be either inline raw string of public
                            jwks or kubernetes secret reference.
                          properties:
                            inline:
                              description: Inline PEM formatted public key.
                              type: string
                            secretRef:
                              description: Reference to a secret containing the PEM
                                formatted public key.
                              properties:
                                key:
                                  description: Key of data within specified secret.
                                  type: string
                                objectRef:
                                  description: Secret can be referenced explicitly
                                    by the namespace and cluster containing them.
                                  properties:
                                    cluster:
                                      description: the cluster of the object. if the
                                        field is omitted, Gloo Mesh will use the same
                                        cluster as the parent object containing this
                                        reference.
                                      type: string
                                    name:
                                      description: the name of the object
                                      type: string
                                    namespace:
                                      description: the namespace of the object. if
                                        the field is omitted, Gloo Mesh will use the
                                        same namespace as the parent object containing
                                        this reference.
                                      type: string
                                  type: object
                              type: object
                          type: object
                        remote:
                          description: JWKS from remote url source.
                          properties:
                            cacheDuration:
                              description: |-
                                Duration after which the cached JWKS should be expired.

                                If not specified, default cache duration is 5 minutes.
                              type: string
                            destinationRef:
                              description: The remote destination representing the
                                Json Web Key Set server
                              properties:
                                kind:
                                  description: the kind of destination being selected.
                                    defaults to Kubernetes Service.
                                  enum:
                                  - SERVICE
                                  - VIRTUAL_DESTINATION
                                  - EXTERNAL_SERVICE
                                  type: string
                                port:
                                  description: the port on the destination object
                                    being targeted. required if the object provides
                                    more than one port.
                                  oneOf:
                                  - not:
                                      anyOf:
                                      - required:
                                        - number
                                      - required:
                                        - name
                                  - required:
                                    - number
                                  - required:
                                    - name
                                  properties:
                                    name:
                                      description: the name of the port on the destination
                                        objects being targeted.
                                      type: string
                                    number:
                                      description: the number of the port on the destination
                                        objects being targeted.
                                      maximum: 4294967295
                                      minimum: 0
                                      type: integer
                                  type: object
                                ref:
                                  description: reference to the destination object
                                    by its metadata
                                  properties:
                                    cluster:
                                      description: the cluster of the object. if the
                                        field is omitted, Gloo Mesh will use the same
                                        cluster as the parent object containing this
                                        reference.
                                      type: string
                                    name:
                                      description: the name of the object
                                      type: string
                                    namespace:
                                      description: the namespace of the object. if
                                        the field is omitted, Gloo Mesh will use the
                                        same namespace as the parent object containing
                                        this reference.
                                      type: string
                                  type: object
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: select a subset of the destination's
                                    endpoints for routing based on their labels.
                                  type: object
                                weight:
                                  description: |-
                                    Specify the proportion of traffic to be forwarded to this destination.
                                    Weights across all of the `destinations` must sum to 100.
                                    Weight is only relevant when used in the context of a route with multiple destinations.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                              type: object
                            enableAsyncFetch:
                              description: |-
                                Fetch Jwks asynchronously in the main thread before the listener is activated. Fetched Jwks can be used by all worker threads.

                                If this feature is not enabled:

                                    * The Jwks is fetched on-demand when the requests come. During the fetching, first
                                      few requests are paused until the Jwks is fetched.
                                    * Each worker thread fetches its own Jwks since Jwks cache is per worker thread.

                                If this feature is enabled:

                                    * Fetched Jwks is done in the main thread before the listener is activated. Its fetched
                                      Jwks can be used by all worker threads. Each worker thread doesn't need to fetch its own.
                                    * Jwks is ready when the requests come, not need to wait for the Jwks fetching.
                              type: boolean
                            timeout:
                              description: |-
                                Sets the maximum duration in seconds that a response can take to arrive upon request.

                                If left empty, defaults to 5s
                              type: string
                            url:
                              description: |-
                                The url used when accessing the remote destination for Json Web Key Set.
                                This is used to set the host and path in the request
                              type: string
                          type: object
                        tokenSource:
                          description: |-
                            Optional: If no explicit location is specified, the following default locations are tried in order:

                            1. The Authorization header using the `Bearer `

                               Authorization: Bearer <token>.

                            2. `access_token` query parameter

                               https://<url>/path?access_token=<token>

                            Multiple JWTs can be verified for a request. Each JWT has to be extracted from the locations
                            its provider specified or from the default locations. Note if a single request contains multiple
                            sources e.g header and query param set, then all tokens found in the request will need to be valid
                            for the request to be accepted. Configured fields are case sensitive will be matched verbatim
                          properties:
                            headers:
                              description: Try to retrieve token from these headers
                              items:
                                properties:
                                  name:
                                    description: 'The name of header. E.g: "Authorization"'
                                    type: string
                                  prefix:
                                    description: Prefix before the token. for example,
                                      "Bearer " with space
                                    type: string
                                type: object
                              type: array
                            queryParams:
                              description: Try to retrieve token from these query
                                params
                              items:
                                type: string
                              type: array
                          type: object
                      type: object
                    description: |-
                      Map provider name to jwt provider configuration.

                      Note: The JWT provider name can help you map the JWT policy to the
                      provider, such as when debugging and viewing logs. However, the JWT
                      provider name does not change your policy's behavior, and cannot be
                      used by other resources to select the policy.
                    type: object
                type: object
            type: object
          status:
            description: reflects the status of the JWTPolicyStatus
            properties:
              global:
                properties:
                  message:
                    description: |-
                      Additional information about the current state of the resource across all
                      workspace clusters.
                    type: string
                  state:
                    description: |-
                      Whether the resource has been accepted as valid and processed in workspace
                      clusters that it exists in.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - WARNING
                    - FAILED
                    - UNLICENSED
                    type: string
                type: object
              selectedRoutes:
                description: Routes selected by the policy
                items:
                  properties:
                    routeIndex:
                      description: The index of the route on the route table
                      format: int32
                      type: integer
                    routeName:
                      description: The name of the route
                      type: string
                    routeTable:
                      description: The route table containing the route
                      properties:
                        cluster:
                          description: the cluster of the object. if the field is
                            omitted, Gloo Mesh will use the same cluster as the parent
                            object containing this reference.
                          type: string
                        name:
                          description: the name of the object
                          type: string
                        namespace:
                          description: the namespace of the object. if the field is
                            omitted, Gloo Mesh will use the same namespace as the
                            parent object containing this reference.
                          type: string
                      type: object
                  type: object
                type: array
              workspaces:
                additionalProperties:
                  properties:
                    clusters:
                      additionalProperties:
                        properties:
                          generic:
                            properties:
                              message:
                                description: Additional information about the current
                                  state of the resource.
                                type: string
                              observedGeneration:
                                description: |-
                                  The most recent generation observed in the the object's metadata.
                                  If the `observedGeneration` does not match `metadata.generation`, Gloo Mesh
                                  has not processed the most recent version of this object.
                                format: int64
                                type: integer
                              state:
                                description: |-
                                  Whether the resource has been accepted as valid and processed in the Gloo
                                  Mesh config translation.
                                enum:
                                - PENDING
                                - ACCEPTED
                                - INVALID
                                - WARNING
                                - FAILED
                                - UNLICENSED
                                type: string
                              updatedAt:
                                description: The last time the status was updated.
                                format: date-time
                                type: string
                            type: object
                        type: object
                      description: |-
                        The status of the resource in each cluster within the
                        workspace.
                      type: object
                  type: object
                description: The status of the resource in each workspace that it
                  exists in.
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
